steps:   

#Need to sign all Python files before copying them.
- template: v1/steps/Pdg.Build.SignServiceFiles.yml@pdgTemplates
  parameters:
    folderToScan: $(Build.SourcesDirectory)/src/

- task: ArchiveFiles@2
  displayName: "Archive Power BI files"
  inputs:
    rootFolderOrFile: '$(Build.SourcesDirectory)/powerbi'
    includeRootFolder: false
    archiveType: "tar"
    tarCompression: none
    archiveFile: '$(ob_outputDirectory)/Ev2Deployment/Ev2ServiceArtifactsRoot/powerbi.tar'
    replaceExistingArchive: true
    verbose: true

- task: ArchiveFiles@2
  displayName: "Archive DataQuality"
  inputs:
    rootFolderOrFile: '$(Build.SourcesDirectory)/src/Python/DataEstateHealthLibrary/DataQuality'
    includeRootFolder: false
    archiveType: "tar"
    tarCompression: none
    archiveFile: '$(ob_outputDirectory)/Ev2Deployment/Ev2ServiceArtifactsRoot/DataQuality.tar'
    replaceExistingArchive: true
    verbose: true

- task: ArchiveFiles@2
  displayName: "Archive Catalog"
  inputs:
    rootFolderOrFile: '$(Build.SourcesDirectory)/src/Python/DataEstateHealthLibrary/Catalog'
    includeRootFolder: false
    archiveType: "tar"
    tarCompression: none
    archiveFile: $(ob_outputDirectory)/Ev2Deployment/Ev2ServiceArtifactsRoot/Catalog.tar'
    replaceExistingArchive: true
    verbose: true  

- task: ArchiveFiles@2
  displayName: "Archive DataEstateHealthLibrary"
  inputs:
    rootFolderOrFile: '$(Build.SourcesDirectory)/src/Python/DataEstateHealthLibrary'
    includeRootFolder: false
    archiveType: "zip"
    archiveFile: '$(ob_outputDirectory)/Ev2Deployment/Ev2ServiceArtifactsRoot/DataEstateHealthLibrary.zip'
    replaceExistingArchive: true
    verbose: true